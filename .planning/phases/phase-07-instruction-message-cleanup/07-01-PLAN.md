# Plan: Instruction Message Cleanup

## Objective

Remove the thumbs up/thumbs down feedback buttons from the initial instruction message in the chat panel. The initial message is instructional text ("Let's get started. Ask or tell me something and I'll retrieve that data."), not a real AI response that requires user feedback.

**Purpose**: Clean up the chat UI by removing inappropriate controls from instructional content
**Output**: Initial instruction message displays without feedback buttons; real AI responses retain feedback buttons

## Execution Context

**Phase**: 7 - Instruction Message Cleanup
**Plan**: 07-01
**Estimated Scope**: Trivial (~30 minutes)
**Type**: CSS styling / UI cleanup

### Key Files

- `src/index.css` - Custom CopilotKit CSS overrides (already has extensive CopilotKit customizations)
- `src/App.tsx` - CopilotChat component configuration (line ~2581-2587)

### Current State

The CopilotChat component is configured with an initial message:
```tsx
<CopilotChat
  labels={{
    initial: "Let's get started. Ask or tell me something and I'll retrieve that data.",
    placeholder: 'Ask about CPU, costs, containers...',
  }}
  className="h-full"
/>
```

This initial message is treated as an assistant message by CopilotKit, which means it receives:
- Message controls (regenerate, copy, thumbs up, thumbs down)
- The same styling as real AI responses

The feedback buttons are inappropriate for an instructional message.

### Analysis

Looking at CopilotKit's implementation:

1. **Messages.tsx**: Creates initial messages via `makeInitialMessages()` with `role: "assistant"`
2. **RenderMessage.tsx**: Passes `onThumbsUp` and `onThumbsDown` callbacks to AssistantMessage
3. **AssistantMessage.tsx**: Renders feedback buttons when these callbacks exist (lines 86-109)

The initial message is the **first message** in the messages array. We can target it using CSS `:first-child` selector on the message container.

### Solution Approach

Use CSS to hide the message controls on the first assistant message in the chat. This approach:
- Does not require modifying CopilotKit library code
- Follows the existing pattern in `index.css` of using CSS overrides for CopilotKit
- Is maintainable and isolated

## Context

The chat panel uses CopilotKit's built-in `<CopilotChat>` component. The project already has extensive CSS customizations for CopilotKit in `src/index.css`, including:
- Transparent backgrounds
- Hidden scrollbars
- Custom header icon sizing
- User message styling

Adding a CSS rule to hide controls on the first message follows this established pattern.

## Tasks

### Task 1: Add CSS to Hide Controls on First Message

**Goal**: Hide the message controls (including feedback buttons) on the initial instruction message

**Files**: `src/index.css`

**Action**:
Add a CSS rule targeting the first message's controls in the CopilotKit chat:

```css
/* Hide feedback/message controls on the initial instruction message */
.copilotKitMessages > .copilotKitMessagesContainer > :first-child .copilotKitMessageControls,
.copilotKitMessages .copilotKitMessagesContainer > :first-child .copilotKitMessageControls {
  display: none !important;
}
```

**Rationale**:
- CopilotKit uses class `copilotKitMessages` for the messages wrapper
- Inside that is `copilotKitMessagesContainer` containing individual messages
- The first child of the container is the initial instruction message
- `copilotKitMessageControls` is the div containing regenerate, copy, and feedback buttons

**Verify**: Initial message shows no feedback buttons; second message (first real response) shows buttons

**Done**: CSS rule added to `src/index.css`

---

### Task 2: Verify First Real Message Retains Controls

**Goal**: Confirm the CSS does not accidentally hide controls on real AI responses

**Files**: None (testing only)

**Action**:
1. Run dev server: `npm run dev`
2. Open http://localhost:3000
3. Verify the initial instruction message has NO feedback buttons
4. Send a test message (click a quick action button like "System metrics")
5. Wait for AI response
6. Verify the AI response DOES have feedback buttons (thumbs up/down visible on hover)

**Verify**: Real AI responses display feedback controls

**Done**: First AI response shows message controls including feedback buttons

---

### Task 3: Build Verification

**Goal**: Ensure no build errors from the CSS changes

**Files**: None (testing only)

**Action**:
Run build command:
```bash
npm run build
```

**Verify**: Build completes successfully with no errors

**Done**: Build passes without errors

## Verification

Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] Initial instruction message has NO feedback buttons or message controls
- [ ] Real AI responses retain feedback buttons (visible on hover)
- [ ] No visual regression in chat styling

## Success Criteria

- [ ] Initial "Let's get started..." message displays without thumbs up/thumbs down buttons
- [ ] Initial message displays without regenerate/copy buttons (all controls hidden)
- [ ] First real AI response displays with all message controls including feedback
- [ ] Build passes (`npm run build`)
- [ ] No visual artifacts or layout issues

## Output

**Files Modified**:
- `src/index.css` - Add CSS rule to hide controls on first message (~5 lines)

**Testing**:
- Visual inspection in browser
- Test both initial state and after first AI response
- Build verification

**Summary**:
After completion, update `.planning/STATE.md` to reflect Phase 7 complete and ready for Phase 8 (Input Box Polish).
